name: è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬

on:
  workflow_dispatch:
  push:
    branches:
      - main

jobs:
  bump-version:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write

    steps:
      # æ£€å‡ºä»£ç 
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v3

      # è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å·
      - name: è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å·
        id: bump_version
        uses: phips28/gh-action-bump-version@master
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          version-type: minor
          tag-prefix: "v"
          commit-message: "ç‰ˆæœ¬æ›´æ–°è‡³ {{version}} ğŸ‰"

      # åˆ›å»ºå¹¶æ¨é€æ–°åˆ†æ”¯
      - name: åˆ›å»ºå¹¶æ¨é€æ–°åˆ†æ”¯
        run: |
          git checkout -b version/v${{ steps.bump_version.outputs.new_version }}
          git push origin version/v${{ steps.bump_version.outputs.new_version }}

      # åˆ›å»º Pull Request
      - name: åˆ›å»º Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          branch: version/v${{ steps.bump_version.outputs.new_version }} # åŠ¨æ€åˆ†æ”¯å
          title: "ç‰ˆæœ¬æ›´æ–°è‡³ v${{ steps.bump_version.outputs.new_version }}"
          body: |
            æ­¤ PR è‡ªåŠ¨æ›´æ–°äº†ç‰ˆæœ¬è‡³ `v${{ steps.bump_version.outputs.new_version }}` ğŸ‰
          base: main
